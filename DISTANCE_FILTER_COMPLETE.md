# โ ูุธุงู ููุชุฑ ุงููุณุงูุฉ ุงูุฏููุงูููู - ูุงูู

## ๐ฏ ุงููููุฒุงุช ุงููุถุงูุฉ

### 1๏ธโฃ **ููุชุฑ ูุณุงูุฉ ูุฑู (0-200 ูู)**
- โ ุงูุญุฏ ุงูุฃุฏูู: **0 ูู** (ุงุจุฏุฃ ูู ูููุนู)
- โ ุงูุญุฏ ุงูุฃูุตู: **200 ูู** (ุฃูุตู ูุทุงู ุจุญุซ)
- โ **ุชุตููู ูุดุจู Facebook Marketplace** ูุน sliders ุณูุณุฉ

### 2๏ธโฃ **ุงูุขููุฉ ุงูุชููุงุฆูุฉ ููุชูุณูุน (Auto-Expand)**
```
ุฅุฐุง ุงุฎุชุงุฑ ุงููุณุชุฎุฏู ูุณุงูุฉ 10 ูู ููู ุชูุฌุฏ ุตูุฏููุงุช:
  โ ูุชู ุงูุจุญุซ ุชููุงุฆูุงู ุญุชู 200 ูู
  โ ุฅุฎุจุงุฑ ุงููุณุชุฎุฏู ุจุงูุชูุณูุน ุงูุชููุงุฆู
  โ ุนุฑุถ ุงูุตูุฏููุงุช ุงููุชุงุญุฉ
```

### 3๏ธโฃ **ุงูุญุฏ ุงูุงูุชุฑุงุถู 30 ูู**
- ุนูุฏ ุงููุชุญ ุงูุฃูู: ูุจุฏุฃ ูู **30 ูู ูุญุฏ ุฃูุตู**
- ูููู ุชูููู ุฃู ุฒูุงุฏุชู ุญุณุจ ุงูุญุงุฌุฉ

---

## ๐ ุงููููุงุช ุงููุนุฏูููุฉ

### 1. `app/prescriptions/select-pharmacies/page.tsx`
```tsx
// ุฅุถุงูุฉ ูุชุบูุฑุงุช ุงูุญุฏ ุงูุฃุฏูู ูุงูุฃูุตู
const [minDistance, setMinDistance] = useState<number>(0)
const [maxDistance, setMaxDistance] = useState<number>(30)
const [autoExpandMessage, setAutoExpandMessage] = useState<string>("")

// ูุงุฌูุฉ ุชูุงุนููุฉ ุจู sliders
<input type="range" min="0" max="200" step="10" value={maxDistance} />

// ุชุตููุฉ ุฏููุงููููุฉ
pharmacies.filter(p => p.distance >= minDistance && p.distance <= maxDistance)
```

### 2. `app/api/prescriptions/nearby-pharmacies/route.ts`
```ts
// ูุจูู minDistance ู maxDistance ูู ุงูุทูุจ
const { minDistance, maxDistance } = await request.json()

// ุชุตููุฉ ุงูุตูุฏููุงุช ุถูู ุงููุทุงู
filter((p) => p.distance >= MIN_DISTANCE && p.distance <= MAX_DISTANCE)

// ุฅุฐุง ูู ุชูุฌุฏ ุตูุฏููุงุชุ ุงูุจุญุซ ุญุชู 200 ูู ุชููุงุฆูุงู
if (nearbyPharmacies.length === 0 && MAX_DISTANCE < 200) {
  nearbyPharmacies = allPharmacies.filter(p => p.distance <= 200)
  isAutoExpanded = true
}
```

### 3. `components/home/pharmacy-map.tsx`
```tsx
// ุฅุถุงูุฉ ููุชุฑ ุงููุณุงูุฉ ูู ุงูุฎุฑูุทุฉ
const [minDistance, setMinDistance] = useState<number>(0)
const [maxDistance, setMaxDistance] = useState<number>(50)

// ุชุทุจูู ุงูููุชุฑ ุนูู ุงูุตูุฏููุงุช ุงููุนุฑูุถุฉ
filtered = filtered.filter((p) => {
  const dist = p.distance || 0
  return dist >= minDistance && dist <= maxDistance
})
```

---

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ูู ุตูุญุฉ ุงูุฅุฑุณุงู (Select Pharmacies)
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ฏ ูุทุงู ุงูุจุญุซ ุนู ุงูุตูุฏููุงุช:                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุงูุญุฏ ุงูุฃุฏูู:  [====โ] 0 ูู                   โ
โ ุงูุญุฏ ุงูุฃูุตู:  [========โ] 30 ูู             โ
โ                                             โ
โ ๐ ุงูุจุญุซ ุนู ุตูุฏููุงุช ุจูู 0 ู 30 ูู           โ
โ                                             โ
โ โน๏ธ (ุฅุฐุง ูู ุชูุฌุฏ ุตูุฏููุงุช):                    โ
โ ูุง ุชูุฌุฏ ุตูุฏููุงุช ูู ุงููุทุงู 0-30 ูู.          โ
โ ูุฌุฏูุง 5 ุตูุฏููุงุช ูู ุงููุทุงู 0-200 ูู!        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ ูุฌุฏูุง 3 ุตูุฏููุงุช ูู ุงููุทุงู ุงููุฎุชุงุฑ
  โก ุตูุฏููุฉ 1 - 12 ูู
  โก ุตูุฏููุฉ 2 - 18 ูู
  โก ุตูุฏููุฉ 3 - 28 ูู
```

### ูู ุงูุฎุฑูุทุฉ (Pharmacy Map)
```
ุชุตููุฉ โ
โโ ๐ฏ ูุทุงู ุงูุจุญุซ:
โ  โโ ุงูุญุฏ ุงูุฃุฏูู: 0 ูู
โ  โโ ุงูุญุฏ ุงูุฃูุตู: 50 ูู
โโ ุญุงูุฉ ุงูุตูุฏููุฉ:
โ  โโ ุงููู / ููุชูุญ / ูุบูู
โโ ๐ ุงูุจุญุซ ุนู ุตูุฏููุงุช ุจูู 0 ู 50 ูู
```

---

## โ๏ธ ุขููุฉ ุงูุนูู

### ุงูุณููุงุฑูู 1: ูุฌูุฏ ุตูุฏููุงุช ูู ุงููุทุงู
```
ุงููุณุชุฎุฏู: ูุฎุชุงุฑ 0-20 ูู
ุงููุธุงู: โ ูุฌุฏูุง 5 ุตูุฏููุงุช
ุนุฑุถ: ุงูุตูุฏููุงุช ุงููุชุงุญุฉ ููุท
```

### ุงูุณููุงุฑูู 2: ุนุฏู ูุฌูุฏ ุตูุฏููุงุช ูู ุงููุทุงู
```
ุงููุณุชุฎุฏู: ูุฎุชุงุฑ 0-10 ูู
ุงููุธุงู: โ๏ธ ูุง ุชูุฌุฏ ุตูุฏููุงุช
ุชููุงุฆูุงู: ุงูุจุญุซ ุญุชู 200 ูู
ุนุฑุถ: โน๏ธ "ุชู ุชูุณูุน ุงููุทุงู ุชููุงุฆูุงู ุฅูู 200 ูู"
      ุงูุตูุฏููุงุช ุงููุชุงุญุฉ ูู ุงููุทุงู ุงูุฌุฏูุฏ
```

### ุงูุณููุงุฑูู 3: ุชุบููุฑ ุงูููุชุฑ ุฏููุงููููุงู
```
ุงููุณุชุฎุฏู: ูุบูุฑ ุงููุณุงูุฉ ูู 30 ุฅูู 50 ูู (ุจุงูู slider)
ุงููุธุงู: ุชุญุฏูุซ ููุฑู ูููุชุงุฆุฌ
ุนุฑุถ: ุชุญุฏูุซ ุนุฏุฏ ุงูุตูุฏููุงุช ุงููุนุฑูุถุฉ
```

---

## ๐ ุณูุฑ ุงูุทูุจ (Request Flow)

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุงููุณุชุฎุฏู ูุฎุชุงุฑ ุงููุณุงูุฉ (min: 0, max: 30)      โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ
                   โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ SELECT PHARMACIES PAGE                          โ
โ โช๏ธ ุชุตููุฉ ุงูุตูุฏููุงุช ูุญููุงู                      โ
โ โช๏ธ ุฅุธูุงุฑ ุงููุชุงุฆุฌ ุงููุทุงุจูุฉ                       โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ
                   โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ API: /api/prescriptions/nearby-pharmacies       โ
โ โช๏ธ ูุจูู minDistance ู maxDistance               โ
โ โช๏ธ ุญุณุงุจ ุงููุณุงูุงุช ุงููุนููุฉ                       โ
โ โช๏ธ ุชุทุจูู ุงูููุชุฑ (min โค distance โค max)        โ
โ โช๏ธ ุฅุฐุง ูุงุฑุบ โ expand ุฅูู 200 ูู ุชููุงุฆูุงู      โ
โ โช๏ธ ุฅุฑุฌุงุน isAutoExpanded flag                    โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ
                   โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุงููุงุฌูุฉ ุชุนุฑุถ:                                   โ
โ โช๏ธ ุงูุตูุฏููุงุช ุงููุฑุดุญุฉ                           โ
โ โช๏ธ ุฑุณุงูุฉ ุงูุชูุณูุน ุงูุชููุงุฆู (ุฅู ูุฌุฏุช)            โ
โ โช๏ธ ุฎูุงุฑ ุงูุฅุฑุณุงู                                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ุฌุฏูู ุงููุณุงูุงุช

| ุงููุทุงู ุงููุฎุชุงุฑ | ุงููุตู | ุงูุณููู |
|---|---|---|
| 0 - 10 ูู | ูุฑูุจ ุฌุฏุงู | โ ุฅุฐุง ุชูุฌุฏุ ุนุฑุถ / โ๏ธ ุฅุฐุง ูุงุ ูุณูุน ุชููุงุฆูุงู |
| 10 - 30 ูู | ูุฑูุจ | โ ุงูุจุญุซ ุงูุนุงุฏู |
| 30 - 50 ูู | ูุชูุณุท | โ ุงูุจุญุซ ุงูุนุงุฏู (ุงูุชุฑุงุถู) |
| 50 - 100 ูู | ุจุนูุฏ | โ ุงูุจุญุซ ุงูุนุงุฏู |
| 100 - 200 ูู | ุจุนูุฏ ุฌุฏุงู | โ ุงูุจุญุซ ุงูุนุงุฏู |

---

## ๐งช ุงุฎุชุจุงุฑ ุงูููุชุฑ

### ุงุฎุชุจุงุฑ 1: ููุชุฑ ุจุญุฏ ุฃุฏูู ูุฃูุตู
```bash
curl -X POST http://localhost:3000/api/prescriptions/nearby-pharmacies \
  -H "Content-Type: application/json" \
  -d '{
    "prescriptionId": "123",
    "userLatitude": 36.75,
    "userLongitude": 3.06,
    "minDistance": 5,
    "maxDistance": 20
  }'

ุงููุชูุฌุฉ ุงููุชููุนุฉ: ุตูุฏููุงุช ููุท ุจูู 5-20 ูู
```

### ุงุฎุชุจุงุฑ 2: ุงูุชูุณูุน ุงูุชููุงุฆู
```bash
# ุงุฎุชุฑ ูุณุงูุฉ ูุตูุฑุฉ ุฌุฏุงู (ูุซู 0-5 ูู)
# ุฅุฐุง ูู ุชูุฌุฏ ุตูุฏููุงุช
# ุงููุธุงู ุณูุชูุณุน ุชููุงุฆูุงู ุฅูู 200 ูู
```

### ุงุฎุชุจุงุฑ 3: ุชุบููุฑ ุงูููุชุฑ
```bash
# ูู ุงูุฎุฑูุทุฉ: ุงุฎุชุฑ "ุชุตููุฉ"
# ุบูุฑ ุงูุญุฏ ุงูุฃุฏูู ูุงูุฃูุตู
# ูุฌุจ ุฃู ุชุชุญุฏุซ ุงููุชุงุฆุฌ ููุฑุงู
```

---

## ๐พ ูุชุบูุฑุงุช API

### Request
```json
{
  "prescriptionId": "string",
  "userLatitude": "number",
  "userLongitude": "number",
  "minDistance": "number (0-200)",
  "maxDistance": "number (0-200)"
}
```

### Response
```json
{
  "prescriptionId": "string",
  "totalPharmacies": "number",
  "minDistance": "number",
  "maxDistance": "number",
  "isAutoExpanded": "boolean",
  "pharmacies": [
    {
      "id": "string",
      "name": "string",
      "latitude": "number",
      "longitude": "number",
      "distance": "number",
      "address": "string",
      "phone": "string"
    }
  ]
}
```

---

## ๐ ุงููููุฒุงุช ุงูุฅุถุงููุฉ

โจ **ุชุญุณููุงุช ุงูุฃุฏุงุก:**
- ุชุตููุฉ ูุญููุฉ ุณุฑูุนุฉ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
- ุญุณุงุจ ุงููุณุงูุงุช ูุฑุฉ ูุงุญุฏุฉ ูู API

โจ **ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู:**
- ุฑุณุงุฆู ูุงุถุญุฉ ุนูุฏ ุงูุชูุณูุน ุงูุชููุงุฆู
- ุชุญุฏูุซ ููุฑู ุนูุฏ ุชุบููุฑ ุงูููุชุฑ
- ุชูุณูู ุจุตุฑู ูุชูููุฒ ุงููุทุงูุงุช

โจ **ุงููุฑููุฉ:**
- ุงูุญุฏ ุงูุฃุฏูู ูุงูุฃูุตู ูุงุจูุงู ููุชุฎุตูุต
- ุงูุชูุณูุน ุงูุชููุงุฆู ูุตู ุฅูู 200 ูู
- ูุนูู ูู ุงูุฎุฑูุทุฉ ูุงูุฅุฑุณุงู ูุนุงู

---

## ๐ฑ ุงุฎุชุจุงุฑ ุนูู ุงูุฌูุงุฒ

1. ุงุฐูุจ ุฅูู ุตูุญุฉ "ุงุฎุชูุงุฑ ุงูุตูุฏููุงุช"
2. ุบูุฑ ุงูุญุฏ ุงูุฃุฏูู ูุงูุฃูุตู ุจุงุณุชุฎุฏุงู sliders
3. ุดุงูุฏ ุงููุชุงุฆุฌ ุชุชุญุฏุซ ููุฑุงู
4. ุฌุฑุจ ูุณุงูุฉ ูุตูุฑุฉ ุฌุฏุงู ูุชูุนูู ุงูุชูุณูุน ุงูุชููุงุฆู
5. ูู ุงูุฎุฑูุทุฉุ ุงุฎุชุฑ "ุชุตููุฉ" ูุฌุฑุจ ููุณ ุงูุดูุก

---

**ุชู ุงูุชุทุจูู ุจูุฌุงุญ! โ**

