# ุญู ูุดููุฉ ุนุฏู ุธููุฑ ุงูุตูุฏููุงุช ุนูู ุงูุฎุฑูุทุฉ

## ุงููุดููุฉ ๐ด
ุงูุตูุฏููุงุช ูุง ุชุธูุฑ ุนูู ุงูุฎุฑูุทุฉ ุฑุบู ุฃู ุงูุงุดุชุฑุงู ููุนูู

## ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:
1. โ ุงูุตูุฏููุงุช ุบูุฑ ูุนุชูุฏุฉ (`is_verified = false`)
2. โ ุงูุงุดุชุฑุงูุงุช ุจุญุงูุฉ "pending" ุจุฏูุงู ูู "active"
3. โ ุงูุงุดุชุฑุงูุงุช ููุชููุฉ ุงูุตูุงุญูุฉ (`expires_at < NOW()` ุฃู NULL)
4. โ ูุนูููุงุช ุงููููุน ูุงูุตุฉ (latitude/longitude = NULL)
5. โ ูุง ุชูุฌุฏ ุงุดุชุฑุงูุงุช ูุดุทุฉ ุตุงูุญุฉ

## ุงูุญู ุงูุดุงูู โ

### ููุฎุต ุงููุดููุฉ ุงููุนููุฉ:
- โ ุฎุทุฃ Foreign Key: ูุง ูููู ุฅุถุงูุฉ ุญุณุงุจุงุช ุฌุฏูุฏุฉ ูุจุงุดุฑุฉ ุจุฏูู `auth.users`
- โ ุงูุญู: ุชุญุฏูุซ ุงูุตูุฏููุงุช ุงูููุฌูุฏุฉ ุจุงููุนู ููุท

### ุงูุฎุทูุฉ 1: ุชุดุฎูุต ุงููุดููุฉ (ุงุฎุชูุงุฑู)
1. ุงุฐูุจ ุฅูู **Supabase Dashboard**
2. ุงุฐูุจ ุฅูู **SQL Editor**
3. **ูุณุฎ ููุตู** ุงูุณูุฑูุจุท ูู: `scripts/100_diagnostic_pharmacies.sql`
4. ุงุถุบุท **Run** ูุชุญูู ูู:
   - ุนุฏุฏ ุงูุตูุฏููุงุช ุงูููุฌูุฏุฉ ุจุงููุนู
   - ุญุงูุฉ `is_verified` (ูู ูุนุชูุฏุฉุ)
   - ุญุงูุฉ `latitude/longitude` (NULL ุฃู ูููุฉุ)
   - ุนุฏุฏ ุงูุงุดุชุฑุงูุงุช ุงููุดุทุฉ ุงูุตุงูุญุฉ

### ุงูุฎุทูุฉ 2: ุชุทุจูู ุงูุญู โ **ุงูุฎุทูุฉ ุงูุฑุฆูุณูุฉ**
1. ุงุฐูุจ ุฅูู **Supabase Dashboard**
2. ุงุฐูุจ ุฅูู **SQL Editor**  
3. **ูุณุฎ ููุตู** ุงูุณูุฑูุจุท ุงููุงูู ูู: `scripts/026_fix_pharmacies_display.sql`
4. ุงุถุบุท **Run/Execute**

**ูุงุฐุง ุณูุญุฏุซ ุจุนุฏ ุชุดุบูู ุงูุณูุฑูุจุท:**
- โ ุชุญุฏูุซ ุฌููุน ุงูุตูุฏููุงุช ุงูููุฌูุฏุฉ ูุชููู ูุนุชูุฏุฉ (`is_verified = true`)
- โ ุฅุถุงูุฉ ููุงูุน ููุตูุฏููุงุช ุงูุชู ุจุฏูููุง (ุจุงููุฑุจ ูู ุงูุฌุฒุงุฆุฑ)
- โ ุชุญุฏูุซ ุงูุงุดุชุฑุงูุงุช ูู "pending" ุฅูู "active"
- โ ุชุนููู ุชูุงุฑูุฎ ุงูุชูุงุก ุตุญูุญุฉ ููุงุดุชุฑุงูุงุช (30 ููู ูู ุงูุขู)
- โ ุฅุถุงูุฉ ุงุดุชุฑุงูุงุช ููุตูุฏููุงุช ุงูุชู ูุง ุชููู ุงุดุชุฑุงูุงุช ูุดุทุฉ

### ุงูุฎุทูุฉ 3: ุงูุชุญูู ูู ุงูุญู โ
1. ุงุฐูุจ ุฅูู ุงูุชุทุจูู: `http://localhost:3002/home`
2. ูู ุจุชุญุฏูุซ ุงูุตูุญุฉ:
   - **Windows/Linux**: ุงุถุบุท `F5` ุฃู `Ctrl+R`
   - **macOS**: ุงุถุบุท `Cmd+R`
   - **ูุณุญ ูุงูู**: `Ctrl+Shift+R` (ุฃู `Cmd+Shift+R` ุนูู macOS)
3. **ุงููุชูุฌุฉ ุงููุชููุนุฉ:** ุณุชุธูุฑ ุงูุตูุฏููุงุช ุนูู ุงูุฎุฑูุทุฉ! ๐

### ุงูุฎุทูุฉ 4: ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ุฅุฐุง ูู ุชุธูุฑ ุงูุตูุฏููุงุช
### ุงูุฎุทูุฉ 4: ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ุฅุฐุง ูู ุชุธูุฑ ุงูุตูุฏููุงุช

**ุงูุชุญ Developer Tools:**
- ุงุถุบุท `F12` ุฃู `Ctrl+Shift+I` (ุฃู `Cmd+Option+I` ุนูู macOS)
- ุงูุธุฑ ุฅูู ุชุจููุจ **Console**

**ุณุชุฌุฏ ุฑุณุงุฆู ุชุดุฎูุตูุฉ ูุซู:**
```
โ Final result: 3 pharmacies returned
๐ท PharmacyMap received initialPharmacies: [...]
๐ท InteractiveMap received pharmacies: 3 pharmacies
```

**ุฅุฐุง ูุงู ุงููุฌููุน 0 ุตูุฏููุงุช:**
- ุชุฃูุฏ ูู ุชุดุบูู ุงูุณูุฑูุจุท ุจูุฌุงุญ (ูุง ุชูุฌุฏ ุฃุฎุทุงุก ุญูุฑุงุก)
- ุชุญูู ูู ุฃูู ุชูุฌุฏ ุตูุฏููุงุช ูู ุฌุฏูู `pharmacy_profiles`
- ุดุบูู ุงูุณูุฑูุจุท ุงูุชุดุฎูุตู ูุฑุฉ ุฃุฎุฑู

---

## ุชูุงุตูู ุฅุถุงููุฉ

### ุงูุญููู ุงููููุฉ ููุตูุฏููุงุช:

#### ูู ุฌุฏูู `pharmacy_profiles`:
- `id`: ูุนุฑูู ุงูุตูุฏููุฉ (UUID) โ ูุทููุจ
- `pharmacy_name`: ุงุณู ุงูุตูุฏููุฉ โ ูุทููุจ
- `latitude`: ุฎุท ุงูุนุฑุถ (0-90) โ ูุทููุจ ููุฎุฑูุทุฉ
- `longitude`: ุฎุท ุงูุทูู (-180 ุฅูู 180) โ ูุทููุจ ููุฎุฑูุทุฉ
- `is_verified`: ูู ูุนุชูุฏุฉ (true/false) โ ูุฌุจ ุฃู ูููู **true**

#### ูู ุฌุฏูู `subscriptions`:
- `pharmacy_id`: ูุนุฑูู ุงูุตูุฏููุฉ โ ูุทููุจ
- `status`: ุญุงูุฉ (pending/active/rejected/expired) โ ูุฌุจ ุฃู ูููู **"active"**
- `expires_at`: ุชุงุฑูุฎ ุงูุงูุชูุงุก โ ูุฌุจ ุฃู ูููู **> NOW()**
- `plan_type`: ููุน ุงูุฎุทุฉ (monthly/yearly) โ ูุทููุจ

### ุฅุญุฏุงุซูุงุช ูุฏู ุฌุฒุงุฆุฑูุฉ ูููุฑุฌุนูุฉ:
```
ุงูุฌุฒุงุฆุฑ (ุงูุนุงุตูุฉ):  36.7538ยฐN, 3.0588ยฐE
ููุฑุงู:             35.7595ยฐN, -0.6401ยฐE  
ูุณูุทููุฉ:           36.3657ยฐN, 6.6159ยฐE
ุชููุณุงู:            35.2961ยฐN, -1.3207ยฐE
ุชูุงุฑุช:             35.3758ยฐN, 1.3198ยฐE
```

### ููููุฉ ุชุญุฏูุซ ุตูุฏููุฉ ููุฌูุฏุฉ ูุฏูููุงู:
```sql
-- ุชุญุฏูุซ ูููุน ุตูุฏููุฉ
UPDATE public.pharmacy_profiles
SET 
  latitude = 36.7538,
  longitude = 3.0588,
  is_verified = true,
  updated_at = now()
WHERE pharmacy_name = 'ุงุณู ุงูุตูุฏููุฉ';

-- ุงูุชุฃูุฏ ูู ูุฌูุฏ ุงุดุชุฑุงู ูุดุท
INSERT INTO public.subscriptions (pharmacy_id, plan_type, status, expires_at, created_at)
VALUES (
  (SELECT id FROM pharmacy_profiles 
   WHERE pharmacy_name = 'ุงุณู ุงูุตูุฏููุฉ' LIMIT 1),
  'monthly',
  'active',
  now() + interval '30 days',
  now()
)
ON CONFLICT DO NOTHING;
```

---

## ููุงุญุธุงุช ูุงูุฉ

๐ **ุงูุชุทุจูู ูุนุฑุถ ุตูุฏููุฉ ููุท ุฅุฐุง:**
1. โ ูุงูุช ูุนุชูุฏุฉ (`is_verified = true`)
2. โ ูุงู ูุฏููุง ุงุดุชุฑุงู ูุดุท (`status = 'active'`)
3. โ ุงูุงุดุชุฑุงู ูู ููุชูู (`expires_at > NOW()`)
4. โ ุชููู ูุนูููุงุช ูููุน ุตุญูุญุฉ (latitude/longitude ููุณุช NULL)

๐ **ุฃุซูุงุก ุงูุฅุตูุงุญ:**
- ุงููุณุงูุงุช ูู ูููุน ุงููุณุชุฎุฏู ุชูุญุณุจ ุชููุงุฆูุงู
- ุงูุตูุฏููุงุช ุชูุฑุชุจ ุญุณุจ ุงููุฑุจ ูู ุงููุณุชุฎุฏู
- ุงููุณุงูุฉ ุงููุตูู ููุนุฑุถ ูู 50 ูู (ุชูุฑูุจุงู)

๐ **ูู ุญุงูุฉ ูุดุงูู:**
- ุชุฃูุฏ ูู ุฃู ุงูุฎุงุฏู ูุนูู: `http://localhost:3002`
- ุฌุฑุจ ูุณุญ ุงููุงุด: `Ctrl+Shift+R`
- ุงูุชุญ DevTools ูุงูุฑุฃ ุงูุฑุณุงุฆู ุงูุญูุฑุงุก
- ุชุญูู ูู Supabase Logs ููุฃุฎุทุงุก

---

**ุงูุขู ุฌุงูุฒ ููุจุฏุก! ๐**
